<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>アクセス - 第48回 技科大祭</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="技科大祭の公式ホームページです。会場へのアクセス情報をご案内します。">
	<link rel="stylesheet" href="css/style.css">
	<link rel="icon" href="images/HP_icon.png">
</head>

<body>
<div id="container">

<header>
	<div id="logo">
		<a href="index.html">
			<div id="daigaku">豊橋技術科学大学</div>
			<div id="gikadaisai">第48回技科大祭</div>
		</a>
	</div>

	<div id="menubar">
		<nav>
			<ul>
				<li><a href="index.html">トップ</a></li>
				<li class="ddmenu_parent"><a href="#">企画</a>
					<ul>
						<li><a href="events.html">イベント</a></li>
						<li><a href="shops.html">模擬店・キッチンカー</a></li>
						<li><a href="timetable.html">タイムテーブル</a></li>
					</ul>
				</li>
				<li><a href="outline.html">協賛</a></li>
				<li><a href="access.html">アクセス</a></li>
				<li><a href="contact.html">お問い合わせ</a></li>
			</ul>
		</nav>
	</div>
	</header>

<div id="contents">

<main>
	<h2><span>Access</span><span class="hosoku">会場アクセス</span></h2>

	<section class="map-container">
		<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3280.1582743817758!2d137.40748281152807!3d34.70118767280656!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6004d486441646c7%3A0xb819d28be7a7df7f!2z6LGK5qmL5oqA6KGT56eR5a2m5aSn5a2m!5e0!3m2!1sja!2sjp!4v1754376149619!5m2!1sja!2sjp" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
	</section>

	<section class="bg1">
		<div class="access-container">
			<div class="access-info">
				<div class="access-method">
					<h4><i class="fas fa-train-subway"></i>電車・バスでお越しの方</h4>
					<div class="access-description">
						<p><strong>JR各線・名鉄名古屋本線「豊橋駅」</strong>で下車。<br>豊橋駅東口バス乗り場から豊鉄バス「技科大線」に乗車（約25分）、「技科大前」バス停下車すぐ。</p>
						<div class="bus-countdown-wrapper">
							<h5><i class="fas fa-bus"></i>技科大線の出発案内（豊橋駅前 発）</h5>
							<p id="bus-schedule-note" class="note"></p>
							<div id="bus-countdown-display">
								<p>次の出発まであと</p>
								<div class="time-container">
									<span id="bus-minutes">--</span><small>分</small>
									<span id="bus-seconds">--</span><small>秒</small>
								</div>
							</div>
							<p class="next-bus-info">発車時刻: <span id="next-bus-time">--:--</span></p>
						</div>
					</div>
				</div>
				<div class="access-method">
					<h4><i class="fas fa-car"></i>お車でお越しの方</h4>
					 <div class="access-description">
						<p>東名高速道路「豊川IC」より約40分。<br>国道23号線バイパス「豊橋東IC」より約10分。</p>
						<p class="note">※当日は駐車場の混雑が予想されます。可能な限り公共交通機関のご利用にご協力ください。</p>
					</div>
				</div>
			</div>
			<div class="map-button-container">
				<a href="https://www.google.com/maps/dir/?api=1&destination=${%E8%B1%8A%E6%A9%8B%E6%8A%80%E8%A1%93%E7%A7%91%E5%AD%A6%E5%A4%A7%E5%AD%A6}" target="_blank" class="map-button">
					<span class="map-button-icon"><i class="fas fa-map-marked-alt"></i></span>
					<span class="map-button-text">
						<strong>Google Mapで経路を確認</strong>
						<small>大学までのルートを検索</small>
					</span>
				</a>
			</div>
		</div>
	</section>
	</main>

</div>
<footer>
	<div class="footer-container">
		<div class="footer-col">
			<div class="logo-footer">
				<a href="index.html">
					<span class="daigaku-footer">豊橋技術科学大学</span>
					<span class="gikadaisai-footer">第48回技科大祭</span>
				</a>
			</div>
			<address class="footer-address">
				〒441-8580<br>
				愛知県豊橋市天伯町雲雀ヶ丘1-1
			</address>
		</div>
		<div class="footer-col">
			<h4>Menu</h4>
			<ul class="footer-nav">
				<li><a href="index.html">トップ</a></li>
				<li><a href="events.html">イベント</a></li>
				<li><a href="shops.html">模擬店・キッチンカー</a></li>
				<li><a href="timetable.html">タイムテーブル</a></li>
				<li><a href="outline.html">協賛</a></li>
				<li><a href="access.html">アクセス</a></li>
				<li><a href="contact.html">お問い合わせ</a></li>
			</ul>
		</div>
		<div class="footer-col">
			<h4>Links</h4>
			<ul class="footer-nav">
				<li><a href="https://www.tut.ac.jp/">大学公式サイト</a></li>
				<li><a href="https://x.com/tut_festival">公式X(Twitter)</a></li>
				<li><a href="https://www.instagram.com/tut_festival/">公式Instagram</a></li>
			</ul>
		</div>
	</div>
	<div class="footer-bottom">
		<small>Copyright&copy; 第48回技科大祭実行委員会 All Rights Reserved.</small>
	</div>
</footer>
<div class="pagetop"><a href="#"><i class="fas fa-angle-double-up"></i></a></div>

</div>
<div id="menubar_hdr">
<span></span><span></span><span></span>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/protonet-jquery.inview/1.1.2/jquery.inview.min.js"></script>

<script src="js/main.js"></script>

<script>
// --- Bus Countdown Timer ---
// --- Bus Countdown Timer (Modified) ---
document.addEventListener('DOMContentLoaded', async function() {
    const countdownDisplayEl = document.getElementById('bus-countdown-display');
    const nextBusTimeEl = document.getElementById('next-bus-time');
    const busScheduleNoteEl = document.getElementById('bus-schedule-note');
    const nextBusInfoEl = document.querySelector('p.next-bus-info');

    async function fetchTimetable() {
        try {
            const response = await fetch('js/timetable.json');
            if (!response.ok) throw new Error('時刻表ファイルが読み込めませんでした。');
            return await response.json();
        } catch (error) {
            console.error(error);
            if(countdownDisplayEl) countdownDisplayEl.innerHTML = "<p>時刻表データを取得できませんでした。</p>";
            return null;
        }
    }

    const timetable = await fetchTimetable();
    if (!timetable || !countdownDisplayEl) return;

    function updateBusCountdown() {
        const now = new Date();
        const day = now.getDay(); // 0 = Sunday, 6 = Saturday
        const currentTime = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');

        let schedule;
        if (day === 6) { // Saturday
            schedule = timetable.saturday;
            busScheduleNoteEl.textContent = "";
            busScheduleNoteEl.style.display = "none";
        } else if (day === 0) { // Sunday
            schedule = timetable.sunday;
            busScheduleNoteEl.textContent = "";
            busScheduleNoteEl.style.display = "none";
        } else { // Weekday
            schedule = timetable.weekday;
            busScheduleNoteEl.textContent = "※表示は平日ダイヤです。技科大祭当日の土日ダイヤとは異なります。";
            busScheduleNoteEl.style.display = "block";
        }

        let nextBus = schedule.find(time => time > currentTime);
        let nextBusDate = new Date();

        // 今日のバスがない場合、明日の始発を探す
        if (!nextBus) {
            const tomorrow = new Date();
            tomorrow.setDate(now.getDate() + 1);
            const tomorrowDay = tomorrow.getDay();
            
            let tomorrowSchedule;
            if (tomorrowDay === 6) { tomorrowSchedule = timetable.saturday; }
            else if (tomorrowDay === 0) { tomorrowSchedule = timetable.sunday; }
            else { tomorrowSchedule = timetable.weekday; }

            nextBus = tomorrowSchedule[0];
            nextBusDate = tomorrow;
        }

        if (!nextBus) {
            countdownDisplayEl.innerHTML = "<p>次のバス情報が見つかりません。</p>";
            if (nextBusTimeEl) nextBusTimeEl.textContent = "--:--";
            return;
        }

        const [hours, minutes] = nextBus.split(':');
        nextBusDate.setHours(hours, minutes, 0, 0);
        
        const distance = nextBusDate.getTime() - now.getTime();
        
        // ★★★★★ ここからが変更点 ★★★★★
        // 次のバスまで1時間以上ある場合はメッセージを表示
        if (distance > 3600000) { // 3,600,000ミリ秒 = 1時間
            countdownDisplayEl.innerHTML = `<p style="font-size: 1.1rem; font-weight: 500;">次のバスは <strong>${nextBus}</strong> 発です</p>`;
            if (nextBusInfoEl) nextBusInfoEl.style.display = 'none'; // 下の発車時刻情報を隠す
        } else {
            // 1時間を切ったらカウントダウンを表示
            if (nextBusInfoEl) nextBusInfoEl.style.display = 'block'; // 発車時刻情報を表示
            
            // カウントダウン用のHTML構造を再設定
            countdownDisplayEl.innerHTML = `
                <p>次のバスまであと</p>
                <div class="time-container">
                    <span id="bus-minutes">--</span><small>分</small>
                    <span id="bus-seconds">--</span><small>秒</small>
                </div>
            `;
            
            const mins = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const secs = Math.floor((distance % (1000 * 60)) / 1000);
            
            const busMinutesEl = document.getElementById('bus-minutes');
            const busSecondsEl = document.getElementById('bus-seconds');

            if(busMinutesEl) busMinutesEl.textContent = mins.toString().padStart(2, '0');
            if(busSecondsEl) busSecondsEl.textContent = secs.toString().padStart(2, '0');
            if(nextBusTimeEl) nextBusTimeEl.textContent = nextBus + " 発";
        }
    }

    setInterval(updateBusCountdown, 1000);
    updateBusCountdown();
});
</script>
</body>
</html>