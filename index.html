<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>第48回 技科大祭</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="技科大祭の公式ホームページです。日程やイベント情報を提供しています。">
	<link rel="stylesheet" href="css/style.css">
	<link rel="icon" href="images/HP_icon.png">
</head>

<body class="home">
<div id="container">

<header>
	<div id="logo">
		<a href="index.html">
			<div id="daigaku">豊橋技術科学大学</div>
			<div id="gikadaisai">第48回技科大祭</div>
		</a>
	</div>

	<!--開閉ブロック-->
	<div id="menubar">
		<nav>
			<ul>
				<li><a href="index.html">トップ</a></li>
				<li class="ddmenu_parent"><a href="#">企画</a>
					<ul>
						<li><a href="events.html">イベント</a></li>
						<li><a href="shops.html">模擬店・キッチンカー</a></li>
						<li><a href="timetable.html">タイムテーブル</a></li>
					</ul>
				</li>
				<li><a href="outline.html">協賛</a></li>
				<li><a href="access.html">アクセス</a></li>
				<li><a href="contact.html">お問い合わせ</a></li>
			</ul>
		</nav>
	</div>
	<!--/#menubar-->
</header>

<div id="contents">

<main>

<section class="lineup">
	<div class="theme">
		<h2 class="theme_h2">今年のテーマ</h2>
		<p class="theme_p">繋ぐ</p>
	</div>
	<div class="poster">
		<img src="data/poster.png" alt="Poster">
	</div>
</section>

<!-- 開催日セクション (再デザイン) -->
<section class="bg1">
	<h2 class="c"><span>Date</span><span class="hosoku">開催日</span></h2>
	<div class="countdown-card">
		<p class="event-date">10月11日(土)・12日(日)</p>
		<p id="countdown-text">開催まで</p>
		<div id="countdown">
			<div class="timer-unit"><span id="days">00</span><p>日</p></div>
			<div class="separator"></div>
			<div class="timer-unit"><span id="hours">00</span><p>時間</p></div>
			<div class="separator"></div>
			<div class="timer-unit"><span id="minutes">00</span><p>分</p></div>
			<div class="separator"></div>
			<div class="timer-unit"><span id="seconds">00</span><p>秒</p></div>
		</div>
	</div>
</section>
<!-- /#開催日セクション -->

<section class="lineup">
	<div class="theme">
		<h2 class="theme_h2">今年のゲスト</h2>
	</div>
	<div class="poster">
		<img src="data/poster_live.png" alt="Poster">
	</div>
</section>

<!-- アクセス情報ブロック -->
<section class="bg1">
	<h2 class="c"><span>Access</span><span class="hosoku">会場アクセス</span></h2>
	<div class="access-container">
		<div class="access-info">
			<div class="access-method">
				<h4><i class="fas fa-train-subway"></i>電車・バスでお越しの方</h4>
				<div class="access-description">
					<p><strong>JR東海道本線「豊橋駅」</strong>で下車。<br>豊橋駅東口バス乗り場から豊鉄バス「技科大線」に乗車（約25分）、「技科大」バス停下車すぐ。</p>
					<!-- Bus Countdown Section -->
					<div class="bus-countdown-wrapper">
						<h5><i class="fas fa-bus"></i>技科大線の出発案内（豊橋駅前 発）</h5>
						<p id="bus-schedule-note" class="note"></p>
						<div id="bus-countdown-display">
							<p>次の出発まであと</p>
							<div class="time-container">
								<span id="bus-minutes">--</span><small>分</small>
								<span id="bus-seconds">--</span><small>秒</small>
							</div>
						</div>
						<p class="next-bus-info">発車時刻: <span id="next-bus-time">--:--</span></p>
					</div>
				</div>
			</div>
			<div class="access-method">
				<h4><i class="fas fa-car"></i>お車でお越しの方</h4>
				 <div class="access-description">
					<p>東名高速道路「豊川IC」より約40分。<br>国道23号線バイパス「豊橋東IC」より約10分。</p>
					<p class="note">※当日は駐車場の混雑が予想されます。可能な限り公共交通機関のご利用にご協力ください。</p>
				</div>
			</div>
		</div>
		<div class="map-button-container">
			<a href="https://www.google.com/maps/place/%E8%B1%8A%E6%A9%8B%E6%8A%80%E8%A1%93%E7%A7%91%E5%AD%A6%E5%A4%A7" target="_blank" class="map-button">
				<span class="map-button-icon"><i class="fas fa-map-marked-alt"></i></span>
				<span class="map-button-text">
					<strong>Google Mapで経路を確認</strong>
					<small>大学までのルートを検索</small>
				</span>
			</a>
		</div>
	</div>
</section>
<!-- /#アクセス情報ブロック -->

</main>

</div>
<!--/#contents-->

<!-- フッター (再デザイン) -->
<footer>
	<div class="footer-container">
		<div class="footer-col">
			<div class="logo-footer">
				<a href="index.html">
					<span class="daigaku-footer">豊橋技術科学大学</span>
					<span class="gikadaisai-footer">第48回技科大祭</span>
				</a>
			</div>
			<address class="footer-address">
				〒441-8580<br>
				愛知県豊橋市天伯町雲雀ヶ丘1-1
			</address>
		</div>
		<div class="footer-col">
			<h4>Menu</h4>
			<ul class="footer-nav">
				<li><a href="index.html">トップ</a></li>
				<li><a href="events.html">イベント</a></li>
				<li><a href="shops.html">模擬店・キッチンカー</a></li>
				<li><a href="timetable.html">タイムテーブル</a></li>
				<li><a href="outline.html">協賛</a></li>
				<li><a href="access.html">アクセス</a></li>
				<li><a href="contact.html">お問い合わせ</a></li>
			</ul>
		</div>
		<div class="footer-col">
			<h4>Links</h4>
			<ul class="footer-nav">
				<li><a href="https://www.tut.ac.jp/">大学公式サイト</a></li>
				<li><a href="https://x.com/tut_festival">公式X(Twitter)</a></li>
				<li><a href="https://www.instagram.com/tut_festival/">公式Instagram</a></li>
			</ul>
		</div>
	</div>
	<div class="footer-bottom">
		<small>Copyright&copy; 第48回技科大祭実行委員会 All Rights Reserved.</small>
		<span class="pr"><a href="https://template-party.com/" target="_blank">《Web Design:Template-Party》</a></span>
	</div>
</footer>
<!-- /#フッター -->


<!--ページの上部へ戻るボタン-->
<div class="pagetop"><a href="#"><i class="fas fa-angle-double-up"></i></a></div>

</div>
<!--/#container-->

<!--開閉ボタン（ハンバーガーアイコン）-->
<div id="menubar_hdr">
<span></span><span></span><span></span>
</div>

<!--jQueryの読み込み-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!--パララックス（inview）-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/protonet-jquery.inview/1.1.2/jquery.inview.min.js"></script>
<script src="js/jquery.inview_set.js"></script>

<!--このテンプレート専用のスクリプト-->
<script src="js/main.js"></script>

<!-- 動的コンテンツ用スクリプト -->
<script>
// --- Festival Countdown Timer ---
const festivalCountDownDate = new Date("Oct 11, 2025 00:00:00").getTime();
const festivalCountdownFunction = setInterval(function() {
    const now = new Date().getTime();
    const distance = festivalCountDownDate - now;
    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    const daysEl = document.getElementById("days");
    const hoursEl = document.getElementById("hours");
    const minutesEl = document.getElementById("minutes");
    const secondsEl = document.getElementById("seconds");

    if(daysEl) daysEl.innerText = days.toString().padStart(2, '0');
    if(hoursEl) hoursEl.innerText = hours.toString().padStart(2, '0');
    if(minutesEl) minutesEl.innerText = minutes.toString().padStart(2, '0');
    if(secondsEl) secondsEl.innerText = seconds.toString().padStart(2, '0');

    if (distance < 0) {
        clearInterval(festivalCountdownFunction);
        const countdownCard = document.querySelector('.countdown-card');
        if(countdownCard) {
            countdownCard.innerHTML = "<p class='event-date'>10月11日(土)・12日(日)</p><p style='font-size: 2rem; font-weight: bold; margin-top: 1rem;'>技科大祭 開催中！</p>";
        }
    }
}, 1000);

// --- Bus Countdown Timer ---
document.addEventListener('DOMContentLoaded', async function() {
    const busMinutesEl = document.getElementById('bus-minutes');
    const busSecondsEl = document.getElementById('bus-seconds');
    const nextBusTimeEl = document.getElementById('next-bus-time');
    const countdownDisplayEl = document.getElementById('bus-countdown-display');
    const busScheduleNoteEl = document.getElementById('bus-schedule-note');

    async function fetchTimetable() {
        try {
            const response = await fetch('js/timetable.json');
            if (!response.ok) {
                throw new Error('時刻表ファイルが読み込めませんでした。');
            }
            return await response.json();
        } catch (error) {
            console.error(error);
            if(countdownDisplayEl) countdownDisplayEl.innerHTML = "<p>時刻表データを取得できませんでした。</p>";
            return null;
        }
    }

    const timetable = await fetchTimetable();
    if (!timetable || !countdownDisplayEl) return;

    function updateBusCountdown() {
        const now = new Date();
        const day = now.getDay(); // 0 = Sunday, 6 = Saturday
        const currentTime = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');

        let schedule;
        if (day === 6) { // Saturday
            schedule = timetable.saturday;
            busScheduleNoteEl.textContent = "";
            busScheduleNoteEl.style.display = "none";
        } else if (day === 0) { // Sunday
            schedule = timetable.sunday;
            busScheduleNoteEl.textContent = "";
            busScheduleNoteEl.style.display = "none";
        } else { // Weekday
            schedule = timetable.weekday;
            busScheduleNoteEl.textContent = "※表示は平日ダイヤです。技科大祭当日の土日ダイヤとは異なります。";
            busScheduleNoteEl.style.display = "block";
        }

        let nextBus = schedule.find(time => time > currentTime);

        if (nextBus) {
            countdownDisplayEl.style.display = "flex";
            const [hours, minutes] = nextBus.split(':');
            const nextBusDate = new Date();
            nextBusDate.setHours(hours);
            nextBusDate.setMinutes(minutes);
            nextBusDate.setSeconds(0);

            const distance = nextBusDate.getTime() - now.getTime();
            const mins = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const secs = Math.floor((distance % (1000 * 60)) / 1000);

            busMinutesEl.textContent = mins.toString().padStart(2, '0');
            busSecondsEl.textContent = secs.toString().padStart(2, '0');
            nextBusTimeEl.textContent = nextBus + " 発";
        } else {
            countdownDisplayEl.innerHTML = "<p>本日の技科大方面バスは終了しました。</p>";
            nextBusTimeEl.textContent = "明日の時刻表をご確認ください";
        }
    }

    setInterval(updateBusCountdown, 1000);
    updateBusCountdown();
});
</script>
</body>
</html>